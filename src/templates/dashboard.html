<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TVWB Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/main.css" rel="stylesheet">
    <link href="/static/css/pre.css" rel="stylesheet">
</head>
<body>
    <div class="container py-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-lg-6">
                <img src="/static/img/tvwb-logo.png" class="img-fluid" style="height: 128px">
            </div>
            <div class="col-lg-6 d-flex align-items-center">
                <div>
                    <div class="text-muted fw-bold">TVWB Dashboard v{{ version }}</div>
                    <div class="text-muted small">TradingView Webhooks Bot</div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div class="row mb-4">
            <div class="col-12">
                <h3 class="mb-4">Settings</h3>
                
                <!-- Registered Actions -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0">Registered Actions ({{ action_list|length }})</h5>
                    </div>
                    <div class="card-body">
                        {% if action_list %}
                            {% for action in action_list %}
                                <div class="alert alert-secondary">
                                    {{ action.name }}
                                </div>
                            {% endfor %}
                        {% else %}
                            <div class="alert alert-warning">No actions registered</div>
                        {% endif %}
                    </div>
                </div>

                <!-- Registered Events -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0">Registered Events ({{ event_list|length }})</h5>
                    </div>
                    <div class="card-body">
                        {% if event_list %}
                            {% for event in event_list %}
                                <div class="alert alert-info">
                                    <h6>{{ event.name }}</h6>
                                    <div class="small mt-2">
                                        <strong>Key:</strong> <code>{{ event.key }}</code>
                                    </div>
                                    <div class="small mt-2">
                                        <strong>Linked Actions:</strong>
                                        {% for action in event._actions %}
                                            <span class="badge bg-secondary">{{ action }}</span>
                                        {% endfor %}
                                    </div>
                                </div>
                            {% endfor %}
                        {% else %}
                            <div class="alert alert-warning">No events registered</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Monitoring Section -->
        <div class="row">
            <div class="col-12">
                <h3 class="mb-4">Monitoring</h3>
                
                <!-- Logs -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">System Logs</h5>
                    </div>
                    <div class="card-body">
                        <div id="logContainer" class="bg-light p-3" style="max-height: 400px; overflow-y: auto;">
                            <!-- Logs will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/handleLogs.js"></script>
    <script src="/static/js/jsonFormatting.js"></script>
</body>
</html>